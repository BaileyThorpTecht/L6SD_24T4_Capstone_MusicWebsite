<!DOCTYPE html>

<html lang="en">
<head>
  <title>Chordial</title>
  {% load django_bootstrap5 %}
  {% bootstrap_css %}
  {% bootstrap_javascript %}
<style>
  * {
    box-sizing: border-box; 
  }

  .fret {
    height: 30px;
  }
</style>
  

</head>
<body>
<!-- Header -->
  <nav class="navbar navbar-expand-lg bg-primary" data-bs-theme="dark">
    <div class="container-fluid">
      {% load static %}
      <a><img src="{% static 'placeholder.png' %}" height="100px" alt="image"></a>
      <h1>Chordial</h1>
      <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNavAltMarkup" aria-controls="navbarNavAltMarkup" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
      </button>
      <button class="btn">
        <h4>Account</h4>
      </button>
      </div>
    </div>
  </nav>    

  <main>
    <div class="container">
      <div class="row">
        <div class="container text-center" style="margin-top:3%;">
          <div class="col text-center d-flex justify-content-center">
            <div class="card" style="width: 64rem;">
              <div class="card-body">

                <!-- fretboard -->
                
                <div id="fretboard" class="container">
                    <p>Loading...</p>
                </div>

                <button id="button-input" class="btn btn-primary">Test</button>
                <span>string:</span>
                <input type="text" id="string-input">
                <span>fret:</span>
                <input type="text" id="fret-input">
                <br>
                <span>remember its 0 indexed</span>



                
              </div>
            </div>
          </div>
          <div class="row float-end" style="margin-inline:3%">
            <button class="btn btn-sm">
              <p>Button</p>
            </button>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="container text-center" style="margin-top:3%;">
          <div class="col text-center d-flex justify-content-center">
            <div class="card" style="width: 64rem;">
              <h5 class="card-title">Chord Section</h5>
              <div class="card-body">
              </div>
            </div>
          </div>
        </div>
      </div>      
      <div class="row">
        <div class="container text-center" style="margin-top:3%;">
          <div class="row">
            <div class="col">
              <div class="text-center d-flex justify-content-center">
                <div class="card" style="width: 29rem;">
                  <h5 class="card-title">Chord Identidication</h5>
                  <div class="card-body">
                    <!-- Content here -->
                  </div>
                </div>
              </div>
              <div style="margin-inline:3%">
                <button class="btn btn-lg">
                  <p>Button</p>
                </button>
              </div>
            </div>
            <div class="col">
              <div class="text-center d-flex justify-content-center">
                <div class="card" style="width: 29rem;">
                  <h5 class="card-title">Chord Saving</h5>
                  <div class="card-body">
                    <!-- Content here -->
                  </div>
                </div>
              </div>
              <div style="margin-inline:3%">
                <button class="btn btn-sm">
                  <p>Button</p>
                </button>
                <button class="btn btn-sm">
                  <p>Button</p>
                </button>
                <button class="btn btn-sm">
                  <p>Button</p>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="container text-center" style="margin-top:3%;">
          <div class="col text-center d-flex justify-content-center">
            <div class="card" style="width: 64rem;">
              <h5 class="card-title">Guide Section</h5>
              <div class="card-body">
                <!-- Content here -->
              </div>
            </div>
          </div>
          <div style="margin-inline:3%">
            <button class="btn btn-sm">
              <p>Button</p>
            </button>
            <button class="btn btn-sm">
              <p>Button</p>
            </button>
            <button class="btn btn-sm">
              <p>Button</p>
            </button>
            <button class="btn btn-sm">
              <p>Button</p>
            </button>
          <div class="row">
            <button class="btn btn-lg">
              <p>Button</p>
            </button>
          </div>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="container text-center" style="margin-top:3%;">
          <div class="col text-center d-flex justify-content-center">
            <div class="card" style="width: 64rem;">
              <h5 class="card-title">Song Playback</h5>
              <div class="card-body">
                <!-- Content here -->
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </main>
  
</body>
</html>


<script>
/* THE PLAN:
    'fretboard' contains all the html content. it contains 6 'strings'. each 'string' contains 13 'frets' (0 to 12)
    there can be extra bonus elements for string and fret No. labels

    const enabledFret html element is defined

    each fret has a click eventListener for changeFret() function

    changeFret(){
    gets the string and fret position of the clicked fret
    sets that fret to be enabled and and others on the same string to be disabled (en/disabled stored in a 2d array or smthn)

    reloads the fretboard with html, but now an enabledFret element is added to the chosen position
    includes the note name

TODO:
    Make it call firstLoadFretboard() when page is opened
    Determine note from string and fret position and show it on that fret
    Give frets an event listener which calls reloadFretboard(), and get the string and fret positions from it

    put a fretboard image in the background
    }
*/

    const fretboard = document.getElementById("fretboard");
    const enabledFretElement = `<svg width="20" height="20">
                                <circle cx="10" cy="10" r="10" stroke="red" stroke-width="1" fill="orange" />
                                <text fill="#ffffff" font-size="10" font-family="Verdana" x="3" y="13">A#</text>
                            </svg>`;
    var selectedFrets = [0,0,0,0,0,0];

    function loadFretboard(currentFrets)
    {
        fretboard.innerHTML = "";

        for (var stringNo = 0; stringNo < 6; stringNo++) { // 6 strings. 
            const startOfString = `<div class="string row">`;
            const endOfString = `</div>`;
            
            let currentStringElement = startOfString;

            for (var fretNo = 0; fretNo < 13; fretNo++) { // 13 fret positions
                const startOfFret = `<div class="fret col bg-secondary border border-primary border-2" >`
                const endOfFret = `</div>`;
                
                let currentFretElement = startOfFret;
                
                let isSelectedFret = currentFrets[stringNo] == fretNo;
                if (isSelectedFret){
                    currentFretElement += enabledFretElement;
                }

                currentFretElement += endOfFret;
                currentStringElement += currentFretElement;
            }
            
            currentStringElement += endOfString;
            fretboard.innerHTML += currentStringElement;
        }
    }

    function firstLoadFretboard()
    {
        loadFretboard(selectedFrets)
    }

    function reloadFretboard()
    {
        //get x and y from whatever input
        let newString = document.getElementById("string-input").value;
        let newFret = document.getElementById("fret-input").value;

        selectedFrets[newString] = newFret;

        loadFretboard(selectedFrets);
    }

    var button = document.getElementById("button-input");
    button.addEventListener("click", reloadFretboard);


</script>